<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link href="#{facesContext.externalContext.requestContextPath}/resources/css/default.css" rel="stylesheet" type="text/css" />
        <link href="#{facesContext.externalContext.requestContextPath}/resources/css/cssLayout.css" rel="stylesheet" type="text/css" />
        <script src="#{facesContext.externalContext.requestContextPath}/js/geral.js" type="text/javascript" />
        <script src="#{facesContext.externalContext.requestContextPath}/js/global.js" type="text/javascript" />
    </h:head>
    <body style="width: 510px;">
        <div align="center">
            <p:ajaxStatus style="width:220px;height:19px;" id="ajaxStatusPanel" onstart="dlg1.show();" oncomplete="dlg1.hide();"/>  
            <p:dialog id="basicDialog" widgetVar="dlg1" modal="true" closable="false" resizable="false" >  
                <h:graphicImage value="/images/ajax-loader-2.gif" />
            </p:dialog> 
            <br/>
            <h:form id="formPessoa" style="width: 700px;">
                <p:messages autoUpdate="true" id="msg"/>
                <p:growl autoUpdate="true" id="eventosmsg" life="5000"/>
                <p:panel id="acordion" style="width: 700px;" >
                    <p:panel id="reenvioEmail" style="border:transparent " >
                        <p:panel rendered="#{crudPerson.reenvio}"  header="RECONFIRMAÇÃO DE INSCRIÇÃO" style="border:transparent " >
                            <h:panelGrid columns="1" style="font-size: 11px;" id="emailReconf1">
                                <h:panelGroup>
                                    <h:outputLabel id="texto" value="Uma inscrição para o CPF foi encontrada, deseja reenviar o email de confirmação?" style="font-weight: bold"/>
                                </h:panelGroup>
                            </h:panelGrid> 
                            <h:panelGrid columns="1" style="font-size: 11px;" id="emailReconf2">
                                <h:panelGroup>
                                    <p:commandButton process="@this" action="#{crudPerson.reenvioEmail}" value="REENVIAR" update="@form"/>
                                </h:panelGroup>
                            </h:panelGrid> 
                        </p:panel>
                    </p:panel>

                    <p:panel id="personData" header="DADOS PESSOAIS" style="border:transparent " >
                        <h:panelGrid columns="4" style="font-size: 11px;" id="part2"> 
                            <h:panelGroup>
                                <h:outputLabel id="cpfLabel" value="CPF" for="cpfValue" style="font-weight: bold"/><br/>
                                <p:inputMask id="cpfField" value="#{crudPerson.person.individual.cpf}" style="width: 100px" disabled="true" mask="999.999.999-99" >
                                </p:inputMask>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="birthLabel" value="NASCIMENTO" for="Nascimento" style="font-weight: bold"/><br/>
                                <p:inputMask  required="true" requiredMessage="Informe a data de nascimento" id="Nascimento"
                                              value="#{crudPerson.person.individual.birthdate}" style="width: 100px" mask="99/99/9999">
                                    <f:convertDateTime pattern="dd/MM/yyyy" locale="pt_BR"/>
                                </p:inputMask>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="genderLabel" value="SEXO" for="genderField" style="font-weight: bold"/><br/>
                                <p:selectOneRadio id="genderField" value="#{crudPerson.person.individual.gender}" required="true" requiredMessage="Informe seu gênero." >
                                    <f:selectItems value="#{apoio.genders}"/>
                                </p:selectOneRadio>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="tpartLabel" value="Profissão" for="tpartField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu id="tpartField" value="#{crudPerson.person.registeredType}" required="true" requiredMessage="Informe sua profissão.">

                                    <f:selectItems value="#{apoio.TPart}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="1" style="font-size: 11px;" id="part3">
                            <h:panelGroup>
                                <h:outputLabel id="countryLabel" value="PAÍS" for="countryField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{crudPerson.person.address.country}" required="true" requiredMessage="Informe o país onde reside."
                                                 id="countryField" style="width: 463px" converter="converter" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <p:ajax update="stateField, cityField, neighField" listener="#{crudPerson.loadStates()}"/>

                                    <f:selectItems value="#{crudPerson.getCountries(null)}" var="c" itemLabel="#{c.name}" itemValue="#{c}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="stateLabel"  value="ESTADO" for="stateField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu disabled="#{crudPerson.disableState}" value="#{crudPerson.person.address.state}" 
                                                 id="stateField" effect="fade" filter="true" filterMatchMode="startsWith" converter="converter" required="true" requiredMessage="Informe o estado que reside."
                                                 style="width: 180px" >
                                    <p:ajax update="cityField, neighField" listener="#{crudPerson.loadCities()}"/>

                                    <f:selectItems  value="#{crudPerson.states}" var="s" itemLabel="#{s.name}" itemValue="#{s}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="cityLabel" value="CIDADE" for="cityField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu disabled="#{crudPerson.disableCity}" value="#{crudPerson.person.address.city}" 
                                                 id="cityField" effect="fade" filter="true" filterMatchMode="startsWith" converter="converter" required="true" requiredMessage="Informe a cidade onde reside."
                                                 style="width: 272px">
                                    <p:ajax update="neighField" listener="#{crudPerson.loadDistricts()}"/>

                                    <f:selectItems value="#{crudPerson.cities}" var="c" itemLabel="#{c.name}" itemValue="#{c}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="neighLabel" value="BAIRRO" for="neighField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu disabled="#{crudPerson.disableDistrict}" value="#{crudPerson.person.address.district}" 
                                                 id="neighField" effect="fade" filter="true" filterMatchMode="startsWith" converter="converter" required="true" requiredMessage="Informe o bairro que reside."
                                                 style="width: 380px">

                                    <f:selectItems value="#{crudPerson.districts}" var="d" itemLabel="#{d.name}" itemValue="#{d}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="zipCodeLabel" value="CEP" for="zipCodeField" style="font-weight: bold"/><br/>
                                <p:inputMask id="zipCodeField" value="#{crudPerson.person.address.cep}" style="width: 70px" mask="99999-999"
                                             required="true" requiredMessage="Informe o CEP."/>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="logLabel" value="LOGRADOURO" for="logField" style="font-weight: bold"/><br/>
                                <p:inputText id="logField" value="#{crudPerson.person.address.street}" style="width: 400px" onkeyup="Maiuscula(this);
                                        notEspecial(this);" 
                                             required="true" requiredMessage="Informe o logradouro da sua residência."/>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="numLabel" value="NÚMERO" for="numField" style="font-weight: bold"/><br/>
                                <p:inputText id="numField" value="#{crudPerson.person.address.number}" style="width: 47px" onkeyup="Maiuscula(this);
                                        notEspecial(this);" 
                                             required="true" requiredMessage="Informe o número da sua residência ou residencial."/>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="compLabel" value="COMPLEMENTO" for="compField" style="font-weight: bold"/><br/>
                                <p:inputText id="compField" value="#{crudPerson.person.address.complement}" style="width: 461px" onkeyup="Maiuscula(this);
                                        notEspecial(this);"/>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="1" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="nameLabel" value="NOME" for="nameField" style="font-weight: bold"/><br/>
                                <p:inputText required="true" requiredMessage="Informe o seu nome" id="nameField" value="#{crudPerson.person.individual.name}" 
                                             style="width: 461px" onkeyup="Maiuscula(this);
                                                     notSpecialAndNumbers(this);"/>
                            </h:panelGroup>
                        </h:panelGrid>

                        <h:panelGrid columns="1" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="instLabel" value="INSTITUIÇÃO" for="instField" style="font-weight: bold"/><br/>
                                <p:inputText required="true" requiredMessage="Informe o sea Instituição" id="instField" value="#{crudPerson.person.individual.institution}" 
                                             style="width: 461px" onkeyup="Maiuscula(this);
                                                     notSpecialAndNumbers(this);"/>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="contactLabel" value="CONTATOS" style="font-weight: bold"/><br/>
                            </h:panelGroup>
                            <h:panelGroup>
                                <p:commandButton value="Add" type="button" onclick="dlg2.show();" />

                            </h:panelGroup>
                        </h:panelGrid>
                        <p:panel id="contactsPanel" header="CONTATOS" style="border:transparent" >
                            <p:dataTable id="contactsTable" rowIndexVar="rowIndex" rowKey="rowIndex" 
                                         var="contact" value="#{crudPerson.person.contacts}" emptyMessage="Nenhum registro encontrado" >  
                                <p:column headerText="N°" >  
                                    <h:outputText value="#{rowIndex + 1}" />  
                                </p:column> 
                                <p:column headerText="Telefone" width="90" >  
                                    <h:outputText value="#{contact.phone}" />  
                                </p:column>  
                                <p:column headerText="Celular" width="90" >  
                                    <h:outputText value="#{contact.cellphone}" />  
                                </p:column>
                                <p:column headerText="Email" >  
                                    <h:outputText value="#{contact.email}"/>  
                                </p:column>

                                <p:column headerText="Principal">  
                                    <p:selectBooleanCheckbox value="#{contact.main}" />
                                </p:column>

                                <p:column headerText="AÇÕES" > 
                                    <p:commandButton action="#" style="width: 30px" update=":formdlg3:pgdlg3" icon="ui-icon-pencil" oncomplete="dlg3.show();" >
                                        <f:setPropertyActionListener target="#{crudPerson.contactEdit}" value="#{contact}"/>
                                    </p:commandButton>
                                    <p:commandButton action="#{crudPerson.deleteContact(contact)}" update="partsTable" style="width: 30px" ajax="false" icon="ui-icon-trash" />
                                </p:column> 

                            </p:dataTable>  
                        </p:panel>

                    </p:panel>
                </p:panel>
                <div align="center">
                    <h:panelGrid columns="1">
                        <p:commandButton action="#{crudPerson.updatePerson()}" value="ATUALIZAR" update="formPessoa" style="width: 130px" ajax="false" onclick="dlg1.show();" oncomplete="dlg1.hide();" />

                    </h:panelGrid>
                </div>
            </h:form>

            <h:form id="formdlg2" style="width: 510px;" prependId="false" >
                <p:dialog header="Effects" widgetVar="dlg2"  height="100">
                    <h:panelGrid id="pgdlg2" columns="3" style="font-size: 11px;">
                        <h:panelGroup>
                            <h:outputLabel id="emailLabel" value="E-MAIL" for="emailField" style="font-weight: bold"/><br/>
                            <p:inputText id="emailField" value="#{crudPerson.contact.email}" style="width: 262px"  
                                         onblur="checkMail(this);" required="true" requiredMessage="Informe seu e-mail para contato."/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="telLabel" value="TELEFONE" for="telField" style="font-weight: bold"/><br/>
                            <p:inputMask id="telField" value="#{crudPerson.contact.phone}" style="width: 85px" mask="(99)9999-9999" 
                                         required="true" requiredMessage="Informe seu telefone para contato."/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="mobLabel" value="CELULAR" for="mobField" style="font-weight: bold"/><br/>
                            <p:inputMask id="mobField" value="#{crudPerson.contact.cellphone}" style="width: 85px" mask="(99)9999-9999" 
                                         required="true" requiredMessage="Informe seu celular para contato."/>
                        </h:panelGroup>

                        <p:commandButton value="Add" action="#{crudPerson.addPersonContact()}"  update=":formPessoa:contactsTable,pgdlg2" oncomplete="dlg2.hide();"/>

                    </h:panelGrid>
                </p:dialog>
            </h:form>

            <h:form id="formdlg3" style="width: 510px;" prependId="false" >
                <p:dialog header="Effects" widgetVar="dlg3"  height="100">
                    <h:panelGrid id="pgdlg3" columns="3" style="font-size: 11px;">
                        <h:panelGroup>
                            <h:outputLabel id="emailEditLabel" value="E-MAIL" for="emailEditField" style="font-weight: bold"/><br/>
                            <p:inputText id="emailEditField" value="#{crudPerson.contactEdit.email}" style="width: 262px"  
                                         required="true" requiredMessage="Informe seu e-mail para contato."/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="telEditLabel" value="TELEFONE" for="telEditField" style="font-weight: bold"/><br/>
                            <p:inputMask id="telEditField" value="#{crudPerson.contactEdit.phone}" style="width: 85px" mask="(99)9999-9999" 
                                         required="true" requiredMessage="Informe seu telefone para contato."/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="mobEditLabel" value="CELULAR" for="mobEditField" style="font-weight: bold"/><br/>
                            <p:inputMask id="mobEditField" value="#{crudPerson.contactEdit.cellphone}" style="width: 85px" mask="(99)9999-9999" 
                                         required="true" requiredMessage="Informe seu celular para contato."/>
                        </h:panelGroup>

                        <p:commandButton value="Edit" action="#{crudPerson.updateIndiContact()}"  update=":formPessoa:contactsTable,pgdlg3" oncomplete="dlg3.hide();"/>

                    </h:panelGrid>
                </p:dialog>
            </h:form>

        </div>
    </body>
</html>
