<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link href="#{facesContext.externalContext.requestContextPath}/resources/css/default.css" rel="stylesheet" type="text/css" />
        <link href="#{facesContext.externalContext.requestContextPath}/resources/css/cssLayout.css" rel="stylesheet" type="text/css" />
        <script src="#{facesContext.externalContext.requestContextPath}/js/geral.js" type="text/javascript" />
        <script src="#{facesContext.externalContext.requestContextPath}/js/global.js" type="text/javascript" />
    </h:head>
    <body style="width: 510px;">

        <div align="center">
            <p:ajaxStatus style="width:220px;height:19px;" id="ajaxStatusPanel" onstart="dlg1.show();" oncomplete="dlg1.hide();"/>  
            <p:dialog id="basicDialog" widgetVar="dlg1" modal="true" closable="false" resizable="false" >  
                <h:graphicImage value="/images/ajax-loader-2.gif" />
            </p:dialog>
            <br/>
            <h:form id="formAtualizerEmpresa" style="width: 580px;">
                <p:messages autoUpdate="true" id="msg"/>
                <p:growl autoUpdate="true" id="eventosmsg" life="5000"/>
                <p:panel id="acordion" style="width: 580px;">
                    <p:panel visible="true" id="companyData" header="DADOS DA EMPRESA" style="border:transparent " >
                        <h:panelGrid columns="3" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="cnpjLabel" value="CNPJ" style="font-weight: bold"/><br/>
                                <p:inputMask id="cnpjField" value="#{crudCompany.person.company.cnpj}" disabled="true"
                                             style="width: 192px" mask="99.999.999/9999-99">
                                </p:inputMask>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="openLabel" value="ABERTURA" style="font-weight: bold"/><br/>
                                <p:inputMask id="openField" value="#{crudCompany.person.company.openingDate}" style="width: 120px" mask="99/99/9999"
                                             validatorMessage="Data inválida" requiredMessage="Informe a data de abertura">
                                    <f:convertDateTime pattern="dd/MM/yyyy" locale="pt_BR"/>
                                </p:inputMask>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="numFunLabel" value="Nº COLABORADORES" style="font-weight: bold"/><br/>
                                <p:inputText id="numFunField" value="#{crudCompany.person.company.employees}" style="width: 120px" requiredMessage="Informe a quantidade de colaboradores" onkeyup="Maiuscula(this);
                                        notEspecial(this);" />
                            </h:panelGroup>
                        </h:panelGrid>

                        <h:panelGrid columns="1" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="nameEmpLabel" value="NOME FANTASIA" for="nameEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="nameEmpField" value="#{crudCompany.person.company.tradeName}" style="width: 461px" 
                                             requiredMessage="Informe o nome fantasia da empresa"  onkeyup="Maiuscula(this);
                                                     notEspecial(this);" />
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="razSocialEmpLabel" value="RAZÃO SOCIAL" for="razSocialEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="razSocialEmpField" value="#{crudCompany.person.company.companyName}" style="width: 461px" 
                                             requiredMessage="Informe a razão social da empresa" onkeyup="Maiuscula(this);
                                                     notEspecial(this);" />
                            </h:panelGroup>
                        </h:panelGrid>

                        <h:panelGrid columns="2" style="font-size: 11px">
                            <h:panelGroup>
                                <h:outputLabel id="sectorLabel" value="SETOR" for="sectorField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{crudCompany.person.company.sector}" effect="fade" filter="true" filterMatchMode="startsWith"
                                                 requiredMessage="Selecione o setor da sua empresa"
                                                 id="sectorField" converter="converter"
                                                 style="width: 140px">
                                    <p:ajax update="porteField" listener="#{crudCompany.loadCompanySize()}"/>
                                    <f:selectItem itemLabel="Selecione um setor ..." itemValue="" noSelectionOption="true" />
                                    <f:selectItems value="#{crudCompany.sectors}" var="sc" itemLabel="#{sc.description}" itemValue="#{sc}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="porteLabel" value="PORTE" for="porteField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{crudCompany.person.company.companySize}" 
                                                 requiredMessage="Selecione o porte da sua empresa"
                                                 id="porteField" converter="converter" filter="true" filterMatchMode="startsWith"
                                                 style="width: 313px">
                                    <f:selectItem itemLabel="Selecione um porte ..." itemValue="" noSelectionOption="true"/>
                                    <f:selectItems value="#{crudCompany.comSizes}" var="cs" itemLabel="#{cs.description}" itemValue="#{cs}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>

                        </h:panelGrid>

                        <h:panelGrid columns="1" style="font-size: 11px">
                            <h:panelGroup>
                                <h:outputLabel id="cnaeLabel" value="ATIVIDADE PRINCIPAL" for="cnaeField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{crudCompany.person.company.cnae}" requiredMessage="Selecione a atividade principal da sua empresa"
                                                 id="cnaeField" converter="converter" 
                                                 style="width: 464px" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <f:selectItem itemLabel="Selecione uma atividade ..." itemValue="" noSelectionOption="true"/>
                                    <f:selectItems value="#{crudCompany.cnaes}" var="cn" itemLabel="#{cn.activity}" itemValue="#{cn}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="countryEmpLabel" value="PAÍS" for="countryEmpField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{crudCompany.person.address.country}" requiredMessage="Selecione o país da sua empresa"
                                                 id="countryEmpField" style="width: 463px" converter="converter" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <p:ajax update="stateEmpField, cityEmpField, neighEmpField" listener="#{crudCompany.loadStates()}"/>
                                    <f:selectItem itemLabel="Selecione o país ..." itemValue="" />
                                    <f:selectItems value="#{crudCompany.countries}" var="x" itemLabel="#{x.name}" itemValue="#{x}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup id="panelEstado">
                                <h:outputLabel id="stateEmpLabel" value="ESTADO" for="stateEmpField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{crudCompany.person.address.state}" 
                                                 id="stateEmpField" converter="converter" required="true" requiredMessage="Informe o estado de sua empresa."
                                                 style="width: 180px" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <p:ajax update="cityEmpField, neighEmpField" listener="#{crudCompany.loadCities()}"/>
                                    <f:selectItem itemLabel="Selecione um estado ..." itemValue="" />
                                    <f:selectItems  value="#{crudCompany.states}" var="y" itemLabel="#{y.name}" itemValue="#{y}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="cityEmpLabel" value="CIDADE" for="cityEmpField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{crudCompany.person.address.city}" requiredMessage="Selecione a cidade da sua empresa"
                                                 id="cityEmpField" converter="converter" 
                                                 style="width: 272px" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <p:ajax update="neighEmpField" listener="#{crudCompany.loadDistricts()}"/>
                                    <f:selectItem itemLabel="Selecione uma cidade ..." itemValue="" />
                                    <f:selectItems value="#{crudCompany.cities}" var="z" itemLabel="#{z.name}" itemValue="#{z}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                        </h:panelGrid>

                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="neighEmpLabel" value="BAIRRO" for="neighEmpField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{crudCompany.person.address.district}" requiredMessage="Selecione o bairro da sua empresa"
                                                 id="neighEmpField" converter="converter"
                                                 style="width: 380px" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <f:selectItem itemLabel="Selecione um bairro ..." itemValue="" />
                                    <f:selectItems value="#{crudCompany.districts}" var="ab" itemLabel="#{ab.name}" itemValue="#{ab}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="zipCodeEmpLabel" value="CEP" for="zipCodeEmpField" style="font-weight: bold"/><br/>
                                <p:inputMask id="zipCodeEmpField" value="#{crudCompany.person.address.cep}" style="width: 70px" 
                                             mask="99999-999" requiredMessage="Informe o CEP da sua empresa"/>
                            </h:panelGroup>
                        </h:panelGrid>

                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="logEmpLabel" value="LOGRADOURO" for="logEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="logEmpField" value="#{crudCompany.person.address.street}" style="width: 400px" 
                                             requiredMessage="Informe o logradouro da sua empresa" onkeyup="Maiuscula(this);
                                                     notEspecial(this);"  />
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="numEmpLabel" value="NÚMERO" for="numEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="numEmpField" value="#{crudCompany.person.address.number}" style="width: 47px" onkeyup="Maiuscula(this);
                                        notEspecial(this);" requiredMessage="Informe o número do endereço comercial da empresa" />
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="compEmpLabel" value="COMPLEMENTO" for="compEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="compEmpField" value="#{crudCompany.person.address.complement}" style="width: 461px" onkeyup="Maiuscula(this);
                                        notEspecial(this);"  />
                            </h:panelGroup>
                        </h:panelGrid> 


                        <p:panel id="partsTable" header="Contacts" style="border:transparent" >
                            <p:commandButton action="#" oncomplete="dlg2.show();" value="Add"/>
                            <p:dataTable id="comContactsTable" rowIndexVar="rowIndex" rowKey="rowIndex" 
                                         var="contact" value="#{crudCompany.person.contacts}" emptyMessage="Nenhum registro encontrado" >  
                                <p:column headerText="N°" >  
                                    <h:outputText value="#{rowIndex + 1}" />  
                                </p:column> 
                                <p:column headerText="Email" width="100" >  
                                    <h:outputText value="#{contact.email}" />  
                                </p:column>  
                                <p:column headerText="Cell Phone" >  
                                    <h:outputText value="#{contact.cellphone}" />  
                                </p:column>
                                <p:column headerText="Telephone" >  
                                    <h:outputText value="#{contact.phone}" />  
                                </p:column>

                                <p:column headerText="Principal">  
                                    <p:selectBooleanCheckbox value="#{contact.main}" />
                                </p:column>

                                <p:column headerText="AÇÕES" > 
                                    <p:commandButton action="#" style="width: 30px" update=":formdlg3:pgdlg3" icon="ui-icon-pencil" oncomplete="dlg3.show();" >
                                        <f:setPropertyActionListener target="#{crudCompany.contactEdit}" value="#{contact}"/>
                                    </p:commandButton>
                                    <p:commandButton action="#{crudCompany.deleteContact(contact)}" update="partsTable" style="width: 30px" ajax="false" icon="ui-icon-trash" />
                                </p:column> 
                            </p:dataTable>  
                        </p:panel>
                    </p:panel>
                    <div align="center">
                        <h:panelGrid columns="1">
                            <p:commandButton action="#{crudCompany.updateCompany()}" value="ATUALIZAR" update="formAtualizerEmpresa" style="width: 130px" ajax="false" onclick="dlg1.show();" oncomplete="dlg1.hide();" >
                            </p:commandButton>

                        </h:panelGrid>
                    </div>
                </p:panel>

            </h:form>

            <h:form id="formdlg2" style="width: 510px;" prependId="false" >
                <p:dialog header="Effects" widgetVar="dlg2"  height="100">
                    <h:panelGrid id="pgdlg2" columns="3" style="font-size: 11px;">
                        <h:panelGroup>
                            <h:outputLabel id="emailLabel" value="E-MAIL" for="emailField" style="font-weight: bold"/><br/>
                            <p:inputText id="emailField" value="#{crudCompany.contact.email}" style="width: 262px"  
                                         required="true" requiredMessage="Informe seu e-mail para contato."/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="telLabel" value="TELEFONE" for="telField" style="font-weight: bold"/><br/>
                            <p:inputMask id="telField" value="#{crudCompany.contact.phone}" style="width: 85px" mask="(99)9999-9999" 
                                         required="true" requiredMessage="Informe seu telefone para contato."/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="mobLabel" value="CELULAR" for="mobField" style="font-weight: bold"/><br/>
                            <p:inputMask id="mobField" value="#{crudCompany.contact.cellphone}" style="width: 85px" mask="(99)9999-9999" 
                                         required="true" requiredMessage="Informe seu celular para contato."/>
                        </h:panelGroup>

                        <p:commandButton value="Add" action="#{crudCompany.addCompanyContact()}"  update=":formAtualizerEmpresa:comContactsTable,pgdlg2" oncomplete="dlg2.hide();"/>

                    </h:panelGrid>
                </p:dialog>
            </h:form>

            <h:form id="formdlg3" style="width: 510px;" prependId="false" >
                <p:dialog header="Effects" widgetVar="dlg3"  height="100">
                    <h:panelGrid id="pgdlg3" columns="3" style="font-size: 11px;">
                        <h:panelGroup>
                            <h:outputLabel id="emailEditLabel" value="E-MAIL" for="emailEditField" style="font-weight: bold"/><br/>
                            <p:inputText id="emailEditField" value="#{crudCompany.contactEdit.email}" style="width: 262px"  
                                         required="true" requiredMessage="Informe seu e-mail para contato."/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="telEditLabel" value="TELEFONE" for="telEditField" style="font-weight: bold"/><br/>
                            <p:inputMask id="telEditField" value="#{crudCompany.contactEdit.phone}" style="width: 85px" mask="(99)9999-9999" 
                                         required="true" requiredMessage="Informe seu telefone para contato."/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="mobEditLabel" value="CELULAR" for="mobEditField" style="font-weight: bold"/><br/>
                            <p:inputMask id="mobEditField" value="#{crudCompany.contactEdit.cellphone}" style="width: 85px" mask="(99)9999-9999" 
                                         required="true" requiredMessage="Informe seu celular para contato."/>
                        </h:panelGroup>

                        <p:commandButton value="Edit" action="#{crudCompany.updateCompanyContact()}"  update=":formAtualizerEmpresa:comContactsTable,pgdlg3" oncomplete="dlg3.hide();"/>

                    </h:panelGrid>
                </p:dialog>
            </h:form>

        </div>

    </body>
</html>
