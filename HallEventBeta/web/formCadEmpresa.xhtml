<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">

    <h:head> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link href="#{facesContext.externalContext.requestContextPath}/resources/css/default.css" rel="stylesheet" type="text/css" />
        <link href="#{facesContext.externalContext.requestContextPath}/resources/css/cssLayout.css" rel="stylesheet" type="text/css" />
        <script src="#{facesContext.externalContext.requestContextPath}/js/geral.js" type="text/javascript" />
        <script src="#{facesContext.externalContext.requestContextPath}/js/global.js" type="text/javascript" />
    </h:head>
    <body style="width: 510px;">
        <div align="center">
            <p:ajaxStatus style="width:220px;height:19px;" id="ajaxStatusPanel" onstart="dlg1.show();" oncomplete="dlg1.hide();"/>  
            <p:dialog id="basicDialog" widgetVar="dlg1" modal="true" closable="false" resizable="false" >  
                <h:graphicImage value="/images/ajax-loader-2.gif" />
            </p:dialog>
            <br/>
            <h:form id="formEmpresa" style="width: 580px;">
                <p:messages autoUpdate="true" id="msg"/>
                <p:growl autoUpdate="true" id="eventosmsg" life="5000"/>
                <p:panel id="acordion" style="width: 580px;">
                    <p:panel visible="true" id="companyData" header="DADOS DA EMPRESA" style="border:transparent " >
                        <h:panelGrid columns="3" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="cnpjLabel" value="CNPJ" for="cnpjField" style="font-weight: bold"/><br/>
                                <p:inputMask id="cnpjField" value="#{cadCompany.personCom.company.cnpj}" required="#{cadCompany.validCompany}" requiredMessage="Informe o CNPJ da empresa"
                                             style="width: 192px" mask="99.999.999/9999-99">
                                    <p:ajax event="blur" listener="#{cadCompany.validateCompany}" update="formEmpresa"/>
                                </p:inputMask>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="openLabel" value="ABERTURA" for="openField" style="font-weight: bold"/><br/>
                                <p:inputMask id="openField" value="#{cadCompany.personCom.company.openingDate}" style="width: 120px" mask="99/99/9999"
                                             required="#{cadCompany.validCompany}" disabled="#{cadCompany.disableFields}" validatorMessage="Data inválida" requiredMessage="Informe a data de abertura">
                                    <f:convertDateTime pattern="dd/MM/yyyy" locale="pt_BR"/>
                                </p:inputMask>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="numFunLabel" value="Nº COLABORADORES" for="numFunField" style="font-weight: bold"/><br/>
                                <p:inputText id="numFunField" value="#{cadCompany.personCom.company.employees}" disabled="#{cadCompany.disableFields}" style="width: 120px" required="#{cadCompany.validCompany}" requiredMessage="Informe a quantidade de colaboradores" onkeyup="Maiuscula(this);
                                        notEspecial(this);" />
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="1" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="nameEmpLabel" value="NOME FANTASIA" for="nameEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="nameEmpField" value="#{cadCompany.personCom.company.tradeName}" disabled="#{cadCompany.disableFields}" style="width: 461px" 
                                             required="#{cadCompany.validCompany}" requiredMessage="Informe o nome fantasia da empresa" onkeyup="Maiuscula(this);notEspecial(this);" />
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="razSocialEmpLabel" value="RAZÃO SOCIAL" for="razSocialEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="razSocialEmpField" value="#{cadCompany.personCom.company.companyName}" disabled="#{cadCompany.disableFields}" style="width: 461px" 
                                             required="#{cadCompany.validCompany}" requiredMessage="Informe a razão social da empresa" onkeyup="Maiuscula(this);
                                        notEspecial(this);" />
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px">
                            <h:panelGroup>
                                <h:outputLabel id="sectorLabel" value="SETOR" for="sectorField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{cadCompany.personCom.company.sector}" disabled="#{cadCompany.disableFields}"
                                                 required="#{cadCompany.validCompany}" requiredMessage="Selecione o setor da sua empresa"
                                                 id="sectorField" converter="converter" effect="fade" filter="true" filterMatchMode="startsWith"
                                                 style="width: 140px">
                                    <p:ajax update="porteField" listener="#{cadCompany.loadCompanySize()}"/>
                                    <f:selectItem itemLabel="Selecione um setor ..." itemValue="" />
                                    <f:selectItems value="#{cadCompany.sectors}" var="sc" itemLabel="#{sc.description}" itemValue="#{sc}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="porteLabel" value="PORTE" for="porteField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{cadCompany.personCom.company.companySize}" disabled="#{cadCompany.disableFields}"
                                                 required="#{cadCompany.validCompany}" requiredMessage="Selecione o porte da sua empresa"
                                                 id="porteField" converter="converter" filter="true" filterMatchMode="startsWith"
                                                 style="width: 313px">
                                    <p:ajax update="cnaeField" listener="#{cadCompany.loadCnaes}"/>
                                    <f:selectItem itemLabel="Selecione um porte ..." itemValue="" />
                                    <f:selectItems value="#{cadCompany.comSizes}" var="cs" itemLabel="#{cs.description}" itemValue="#{cs}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="1" style="font-size: 11px">
                            <h:panelGroup>
                                <h:outputLabel id="cnaeLabel" value="ATIVIDADE PRINCIPAL" for="cnaeField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{cadCompany.personCom.company.cnae}" required="#{cadCompany.validCompany}" requiredMessage="Selecione a atividade principal da sua empresa"
                                                 id="cnaeField" converter="converter" effect="fade" filter="true" filterMatchMode="startsWith" disabled="#{cadCompany.disableFields}"
                                                 style="width: 464px">
                                    <p:ajax update="cnaeField" listener="#{cadCompany.loadCnaes}"/>
                                    <f:selectItem itemLabel="Selecione uma atividade ..." itemValue="" />
                                    <f:selectItems value="#{cadCompany.cnaes}" var="cn" itemLabel="#{cn.activity}" itemValue="#{cn}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="countryEmpLabel" value="PAÍS" for="countryEmpField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{cadCompany.personCom.address.country}" required="#{cadCompany.validCompany}" requiredMessage="Selecione o país da sua empresa"
                                                 id="countryEmpField" effect="fade" filter="true" disabled="#{cadCompany.disableFields}" filterMatchMode="startsWith" style="width: 463px" converter="converter">
                                    <p:ajax update="stateEmpField, cityEmpField, neighEmpField" listener="#{cadCompany.loadStates()}"/>
                                    <f:selectItem itemLabel="Selecione o país ..." itemValue="" />
                                    <f:selectItems value="#{cadCompany.countries}" var="x" itemLabel="#{x.name}" itemValue="#{x}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup id="panelEstado">
                                <h:outputLabel id="stateEmpLabel" value="ESTADO" for="stateEmpField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu disabled="#{cadCompany.disableStateComp}" value="#{cadCompany.personCom.address.state}" 
                                                 id="stateEmpField" converter="converter" required="true" requiredMessage="Informe o estado de sua empresa."
                                                 style="width: 180px" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <p:ajax update="cityEmpField, neighEmpField" listener="#{cadCompany.loadCities()}"/>
                                    <f:selectItem itemLabel="Selecione um estado ..." itemValue="" />
                                    <f:selectItems  value="#{cadCompany.statesComp}" var="y" itemLabel="#{y.name}" itemValue="#{y}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="cityEmpLabel" value="CIDADE" for="cityEmpField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{cadCompany.personCom.address.city}" required="#{cadCompany.validCompany}" requiredMessage="Selecione a cidade da sua empresa"
                                                 id="cityEmpField" converter="converter" disabled="#{cadCompany.disableCityComp}"
                                                 style="width: 272px" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <p:ajax update="neighEmpField" listener="#{cadCompany.loadDistricts()}"/>
                                    <f:selectItem itemLabel="Selecione uma cidade ..." itemValue="" />
                                    <f:selectItems value="#{cadCompany.citiesComp}" var="z" itemLabel="#{z.name}" itemValue="#{z}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="neighEmpLabel" value="BAIRRO" for="neighEmpField" style="font-weight: bold"/><br/>
                                <p:selectOneMenu value="#{cadCompany.personCom.address.district}" required="#{cadCompany.validCompany}" requiredMessage="Selecione o bairro da sua empresa"
                                                 id="neighEmpField" converter="converter" disabled="#{cadCompany.disableDistrictComp}"
                                                 style="width: 380px" effect="fade" filter="true" filterMatchMode="startsWith" >
                                    <f:selectItem itemLabel="Selecione um bairro ..." itemValue="" />
                                    <f:selectItems value="#{cadCompany.districtsComp}" var="ab" itemLabel="#{ab.name}" itemValue="#{ab}"/>
                                </p:selectOneMenu>
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="zipCodeEmpLabel" value="CEP" for="zipCodeEmpField" style="font-weight: bold"/><br/>
                                <p:inputMask id="zipCodeEmpField" value="#{cadCompany.personCom.address.cep}" style="width: 70px" 
                                             mask="99999-999" disabled="#{cadCompany.disableFields}" required="#{cadCompany.validCompany}" requiredMessage="Informe o CEP da sua empresa"/>
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="logEmpLabel" value="LOGRADOURO" for="logEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="logEmpField" disabled="#{cadCompany.disableFields}" value="#{cadCompany.personCom.address.street}" style="width: 400px" 
                                             required="#{cadCompany.validCompany}" requiredMessage="Informe o logradouro da sua empresa" onkeyup="Maiuscula(this);
                                        notEspecial(this);"  />
                            </h:panelGroup>
                            <h:panelGroup>
                                <h:outputLabel id="numEmpLabel" value="NÚMERO" for="numEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="numEmpField" disabled="#{cadCompany.disableFields}" value="#{cadCompany.personCom.address.number}" style="width: 47px" onkeyup="Maiuscula(this);
                                        notEspecial(this);" required="#{cadCompany.validCompany}" requiredMessage="Informe o número do endereço comercial da empresa" />
                            </h:panelGroup>
                        </h:panelGrid>
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="compEmpLabel" value="COMPLEMENTO" for="compEmpField" style="font-weight: bold"/><br/>
                                <p:inputText id="compEmpField" disabled="#{cadCompany.disableFields}" value="#{cadCompany.personCom.address.complement}" style="width: 461px" onkeyup="Maiuscula(this);
                                        notEspecial(this);"  />
                            </h:panelGroup>
                        </h:panelGrid> 
                        
                        
                        
                        <h:panelGrid columns="2" style="font-size: 11px;">
                            <h:panelGroup>
                                <h:outputLabel id="contactComLabel" value="CONTATOS" style="font-weight: bold"/><br/>
                            </h:panelGroup>
                            <h:panelGroup>
                                <p:commandButton disabled="#{cadCompany.disableFields}" value="Add" type="button" onclick="dlg2.show();" />
                                
                            </h:panelGroup>
                        </h:panelGrid>
                        <p:panel id="contactsComPanel" header="CONTATOS" style="border:transparent" >
                            <p:dataTable id="contactsComTable" rowIndexVar="rowIndex" rowKey="rowIndex" 
                                         var="contact" value="#{cadCompany.personCom.contacts}" emptyMessage="Nenhum registro encontrado" >  
                                <p:column headerText="N°" >  
                                    <h:outputText value="#{rowIndex + 1}" />  
                                </p:column> 
                                <p:column headerText="Telefone" width="90" >  
                                    <h:outputText value="#{contact.phone}" />  
                                </p:column>  
                                <p:column headerText="Celular" width="90" >  
                                    <h:outputText value="#{contact.cellphone}" />  
                                </p:column>
                                <p:column headerText="Email" >  
                                    <h:outputText value="#{contact.email}"/>  
                                </p:column>
                                <p:column headerText="Principal">  
                                    <p:selectBooleanCheckbox value="#{contact.main}" />
                                </p:column>
                                <p:column headerText="AÇÕES" > 
                                    <p:commandButton immediate="true" action="#{cadCompany.deleteContact(rowIndex)}" update="contactsComPanel, requiredCom" style="width: 30px" ajax="false" icon="ui-icon-trash" />
                                </p:column> 
                            </p:dataTable>  
                        </p:panel>
                        
                    </p:panel>
                    
                <div align="center">
                    <h:panelGrid columns="2">
                        <p:commandButton action="#{cadCompany.savePersonCompany()}" update="formEmpresa" value="INSCREVER-SE" disabled="#{cadCompany.disableFields}" style="width: 130px" onclick="dlg1.show();" oncomplete="dlg1.hide();" />
                        <p:commandButton action="#{cadCompany.cleanPersonCadastre()}" value="LIMPAR" process="@this" update="formEmpresa" immediate="true" onclick="dlg1.show();" oncomplete="dlg1.hide();" />
                    </h:panelGrid>
                </div>
                </p:panel>
            </h:form>
        
            
            <h:form id="formdlg2" style="width: 510px;" prependId="false" >
                <p:dialog header="Effects" widgetVar="dlg2"  height="100">
                    <h:panelGrid id="pgdlg2" columns="3" style="font-size: 11px;">
                        <h:panelGroup>
                            <h:outputLabel id="emailEmpLabel" value="E-MAIL" for="emailEmpField" style="font-weight: bold"/><br/>
                            <p:inputText id="emailEmpField" value="#{cadCompany.contact.email}" style="width: 262px" 
                                         required="#{cadCompany.validCompany}" requiredMessage="Informe o e-mail da sua empresa" onkeyup="Maiuscula(this);" onblur="checkMail(this);" />
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="telEmpLabel" value="TELEFONE" for="telEmpField" style="font-weight: bold"/><br/>
                            <p:inputMask id="telEmpField" value="#{cadCompany.contact.phone}" required="#{cadCompany.phone}" 
                                         requiredMessage="Você precisa informar ao menos um telefone de contato." onblur="#{cadCompany.inputPhones(true)}" style="width: 85px" mask="(99)9999-9999"/>
                        </h:panelGroup>
                        <h:panelGroup>
                            <h:outputLabel id="mobEmpLabel" value="CELULAR" for="mobEmpField" style="font-weight: bold"/><br/>
                            <p:inputMask id="mobEmpField" value="#{cadCompany.contact.cellphone}" required="#{cadCompany.cellphone}" 
                                         requiredMessage="Você precisa informar ao menos um telefone de contato." onblur="#{cadCompany.inputPhones(true)}" style="width: 85px" mask="(99)9999-9999"/>
                        </h:panelGroup>
                        
                        
                        <p:commandButton value="Add"  action="#{cadCompany.addComContact()}" update=":formEmpresa:contactsComPanel,pgdlg2" oncomplete="dlg2.hide();"/>
                        
                    </h:panelGrid>
                </p:dialog>
            </h:form>
            
            
        </div>
    </body>
</html>
